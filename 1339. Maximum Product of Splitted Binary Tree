
class Solution{
    int total_sum=0;
    long ans=0;
    public int maxProduct(TreeNode root) {
        inorder(root);
        postorder(root);
        int mod=1000000007;
        return (int)(ans%mod);
    }
    public void inorder(TreeNode root){
        if(root==null) return;
        inorder(root.left);
        total_sum+=root.val;
        inorder(root.right);
    }
    public int postorder(TreeNode root){
        if(root==null) return 0;
        int left=postorder(root.left);
        int right=postorder(root.right);
        int sub_sum=left;
        ans=Math.max(ans,(long)(total_sum-sub_sum)*sub_sum);
        sub_sum=right;
        ans=Math.max(ans,(long)(total_sum-sub_sum)*sub_sum);
        sub_sum+=left;
        return sub_sum+root.val;
    }
}
