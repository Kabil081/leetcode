class Solution{
    public String removeDuplicateLetters(String s){
        int lastIndex[]=new int[26];
        char arr[]=s.toCharArray();
        for(int i=0;i<arr.length;i++){
            lastIndex[arr[i]-'a']=i;
        }
        boolean vis[]=new boolean[26];
        Deque<Character> stack=new ArrayDeque<>();
        for(int i=0;i<arr.length;i++){
            char ch=arr[i];
            if(vis[ch-'a']) continue;
            while(!stack.isEmpty() && stack.peekFirst()>ch && lastIndex[stack.peekFirst()-'a']>i){
                vis[stack.pollFirst()-'a']=false;
            }
            vis[ch-'a']=true;
            stack.addFirst(ch);
        }
        StringBuilder sb=new StringBuilder();
        while(!stack.isEmpty()){
            sb.append(stack.pollFirst());
        }
        return sb.reverse().toString();
    }
}
