class Solution{
    public int[] countMentions(int numberOfUsers, List<List<String>> events){
        Set<Integer> online=new HashSet<>();
        int time_limit[]=new int[numberOfUsers];
        for(int i=0;i<numberOfUsers;i++) online.add(i);
        Collections.sort(events,(a,b)->{
            int num1=Integer.parseInt(a.get(1));
            int num2=Integer.parseInt(b.get(1));
            if(num1!=num2) return num1-num2;
            if(a.get(0).equals(b.get(0))) return 0;
            else if(a.get(0).equals("OFFLINE")) return -1;
            return 1;
        });
        int mentions[]=new int[numberOfUsers];
        for(List<String> cur:events){
            String event=cur.get(0);
            int timestamp=Integer.parseInt(cur.get(1));
            for(int i=0;i<numberOfUsers;i++){
                if(!online.contains(i) && time_limit[i]<=timestamp) online.add(i);
            }
            if(event.equals("MESSAGE")){
                if(cur.get(2).equals("ALL")){ 
                    for(int i=0;i<numberOfUsers;i++) mentions[i]++;
                }else if(cur.get(2).equals("HERE")){
                    for(int user:online) mentions[user]++;
                }else{
                    String id[]=cur.get(2).split(" ");
                    for (String c:id){
                        int user = Integer.parseInt(c.substring(2));
                        mentions[user]++; 
                    }   
                }
            }else{
                int user=Integer.parseInt(cur.get(2));
                time_limit[user]=timestamp+60;
                online.remove(user);
            }
        }
        return mentions;
    }
}
