class Solution{
    public int[] avoidFlood(int[] rains) {
        int n=rains.length;
        int res[]=new int[n];
        Arrays.fill(res,-1);
        TreeSet<Integer> sunnyDays=new TreeSet<>();
        Map<Integer,Integer> rainyDays=new HashMap<>();
        for(int day=0;day<n;day++){
            int lake=rains[day];
            if(lake>0){
                if(rainyDays.containsKey(lake)){
                    Integer dryDay=sunnyDays.higher(rainyDays.get(lake));
                    if(dryDay==null) return new int[0];
                    res[dryDay]=lake;
                    sunnyDays.remove(dryDay);
                    rainyDays.put(lake,day);
                }else{
                    rainyDays.put(lake,day);
                }
            }else{
                res[day]=1;
                sunnyDays.add(day);
            }
        }
        return res;
    }
}
